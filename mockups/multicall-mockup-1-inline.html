<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KROM Multicall UI - Matching Current Interface</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: #0a0a0a;
            color: #fafafa;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .card-bg {
            background: #1a1a1a;
        }
        .border-custom {
            border-color: #262626;
        }
        .text-muted {
            color: #737373;
        }
        .expand-transition {
            transition: all 0.2s ease;
        }
        .sub-row {
            background: rgba(15, 15, 15, 0.8);
            border-left: 2px solid #22c55e;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .pulse-dot {
            animation: pulse 2s infinite;
        }
        .expand-arrow {
            transition: transform 0.2s ease;
            color: #737373;
        }
        .expanded .expand-arrow {
            transform: rotate(90deg);
            color: #22c55e;
        }
        table {
            font-size: 14px;
        }
        .hover-row:hover {
            background: rgba(255, 255, 255, 0.02);
        }
    </style>
</head>
<body class="p-6">
    <div class="max-w-full mx-auto">
        <h1 class="text-2xl font-bold mb-2">KROM Analysis - Multicall View</h1>
        <p class="text-muted mb-6">Matching current production interface with expandable multicalls</p>

        <div class="card-bg rounded-lg border border-custom overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="border-b border-custom bg-black/40">
                        <th class="text-left p-3 text-xs font-medium text-muted uppercase tracking-wider"></th>
                        <th class="text-left p-3 text-xs font-medium text-muted uppercase tracking-wider">Date</th>
                        <th class="text-left p-3 text-xs font-medium text-muted uppercase tracking-wider">Token</th>
                        <th class="text-left p-3 text-xs font-medium text-muted uppercase tracking-wider">Caller</th>
                        <th class="text-left p-3 text-xs font-medium text-muted uppercase tracking-wider">Calls</th>
                        <th class="text-right p-3 text-xs font-medium text-muted uppercase tracking-wider">Call Score</th>
                        <th class="text-right p-3 text-xs font-medium text-muted uppercase tracking-wider">X Score</th>
                        <th class="text-right p-3 text-xs font-medium text-muted uppercase tracking-wider">Website</th>
                        <th class="text-right p-3 text-xs font-medium text-muted uppercase tracking-wider">Price at Call</th>
                        <th class="text-right p-3 text-xs font-medium text-muted uppercase tracking-wider">Current Price</th>
                        <th class="text-right p-3 text-xs font-medium text-muted uppercase tracking-wider">ROI</th>
                        <th class="text-right p-3 text-xs font-medium text-muted uppercase tracking-wider">ATH ROI</th>
                        <th class="text-right p-3 text-xs font-medium text-muted uppercase tracking-wider">Market Cap</th>
                        <th class="text-right p-3 text-xs font-medium text-muted uppercase tracking-wider">Liquidity</th>
                        <th class="text-right p-3 text-xs font-medium text-muted uppercase tracking-wider">Volume 24h</th>
                    </tr>
                </thead>
                <tbody id="tokenTable">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Sample data matching current KROM interface structure
        const tokens = [
            {
                ticker: 'YZY',
                network: 'solana',
                contract: 'A9kMqvtFuNDMV3kDQ2fqRLnULLkjkanye',
                fullContract: 'A9kMqvtFuNDMV3kDQ2fqRLnULLkjkanyeSoLPumpFun',
                priceAtCall: 0.00000234,
                currentPrice: 0.001234,
                liquidity: 2450000,
                athRoi: 420.5,
                roi: 527.35,
                marketCap: 8900000,
                volume24h: 1234567,
                callScore: 8,
                xScore: 7,
                websiteScore: 6,
                calls: [
                    { 
                        username: 'earlybird', 
                        message: 'First Kanye call!', 
                        roi: 527.35, 
                        timestamp: '2025-01-21 10:15:00',
                        groupName: 'KROM Premium',
                        priceAtCall: 0.00000234,
                        callScore: 8,
                        xScore: 7
                    },
                    { 
                        username: 'moonshotcalls', 
                        message: 'Kanye back in crypto', 
                        roi: 456.78, 
                        timestamp: '2025-01-21 10:17:00',
                        groupName: 'KROM Alpha',
                        priceAtCall: 0.00000271,
                        callScore: 7,
                        xScore: 8
                    },
                    { 
                        username: 'gemfinder', 
                        message: 'Found the real YZY', 
                        roi: 412.34, 
                        timestamp: '2025-01-21 10:20:00',
                        groupName: 'KROM Elite',
                        priceAtCall: 0.00000299,
                        callScore: 9,
                        xScore: 7
                    },
                    { 
                        username: 'whalewatch', 
                        message: 'Big buys coming in', 
                        roi: 389.12, 
                        timestamp: '2025-01-21 10:23:00',
                        groupName: 'KROM Premium',
                        priceAtCall: 0.00000316,
                        callScore: 8,
                        xScore: 6
                    },
                    { 
                        username: 'traderpro', 
                        message: 'YZY chart looking bullish', 
                        roi: 356.78, 
                        timestamp: '2025-01-21 10:25:00',
                        groupName: 'KROM Alpha',
                        priceAtCall: 0.00000345,
                        callScore: 7,
                        xScore: 8
                    },
                    { 
                        username: 'alphahunter', 
                        message: 'Kanye season', 
                        roi: 298.45, 
                        timestamp: '2025-01-21 10:27:00',
                        groupName: 'KROM Elite',
                        priceAtCall: 0.00000412,
                        callScore: 8,
                        xScore: 7
                    },
                    { 
                        username: 'rocketcalls', 
                        message: 'YZY 100x incoming', 
                        roi: 234.56, 
                        timestamp: '2025-01-21 10:30:00',
                        groupName: 'KROM Premium',
                        priceAtCall: 0.00000525,
                        callScore: 9,
                        xScore: 8
                    },
                    { 
                        username: 'diamondhands', 
                        message: 'Loading bags', 
                        roi: 189.23, 
                        timestamp: '2025-01-21 10:33:00',
                        groupName: 'KROM Alpha',
                        priceAtCall: 0.00000651,
                        callScore: 7,
                        xScore: 7
                    },
                    { 
                        username: 'moonshot', 
                        message: 'Real Ye confirmed', 
                        roi: 156.78, 
                        timestamp: '2025-01-21 10:35:00',
                        groupName: 'KROM Elite',
                        priceAtCall: 0.00000789,
                        callScore: 8,
                        xScore: 6
                    },
                    { 
                        username: 'degen123', 
                        message: 'YZY to the moon', 
                        roi: 123.45, 
                        timestamp: '2025-01-21 10:37:00',
                        groupName: 'KROM Premium',
                        priceAtCall: 0.00000984,
                        callScore: 7,
                        xScore: 7
                    },
                    { 
                        username: 'cryptowhale', 
                        message: 'Kanye token looks solid', 
                        roi: 98.76, 
                        timestamp: '2025-01-21 10:38:00',
                        groupName: 'KROM Alpha',
                        priceAtCall: 0.00001123,
                        callScore: 8,
                        xScore: 8
                    },
                    { 
                        username: 'VeniseGems', 
                        message: 'Official kanye coin?', 
                        roi: 67.89, 
                        timestamp: '2025-01-21 10:40:00',
                        groupName: 'KROM Premium',
                        priceAtCall: 0.00001456,
                        callScore: 9,
                        xScore: 7
                    },
                    { 
                        username: 'luigiscalls', 
                        message: 'wtf', 
                        roi: 45.67, 
                        timestamp: '2025-01-21 10:42:00',
                        groupName: 'KROM Elite',
                        priceAtCall: 0.00001789,
                        callScore: 6,
                        xScore: 6
                    },
                    { 
                        username: 'kweensjournal', 
                        message: 'another ye play?', 
                        roi: 23.45, 
                        timestamp: '2025-01-21 10:42:30',
                        groupName: 'KROM Elite',
                        priceAtCall: 0.00002123,
                        callScore: 7,
                        xScore: 7
                    },
                    { 
                        username: 'mewgambles', 
                        message: '$YZY YZY real kanye.', 
                        roi: 12.34, 
                        timestamp: '2025-01-21 10:43:00',
                        groupName: 'KROM Premium',
                        priceAtCall: 0.00002456,
                        callScore: 8,
                        xScore: 8
                    }
                ]
            },
            {
                ticker: 'BONK',
                network: 'solana',
                contract: 'DezXAZ8z7PnrnRJjz3wXBoRemBonk',
                fullContract: 'DezXAZ8z7PnrnRJjz3wXBoRembonkSoLRaydiumPump',
                priceAtCall: 0.00001234,
                currentPrice: 0.00002134,
                liquidity: 850000,
                athRoi: 180.2,
                roi: 73.01,
                marketCap: 3200000,
                volume24h: 456789,
                callScore: 7,
                xScore: 6,
                websiteScore: 5,
                calls: [
                    { 
                        username: 'memecollector', 
                        message: 'bonk szn returns', 
                        roi: 73.01, 
                        timestamp: '2025-01-21 10:25:00',
                        groupName: 'KROM Alpha',
                        priceAtCall: 0.00001234,
                        callScore: 7,
                        xScore: 6
                    },
                    { 
                        username: 'degen123', 
                        message: 'aping bonk', 
                        roi: 52.34, 
                        timestamp: '2025-01-21 10:30:00',
                        groupName: 'KROM Elite',
                        priceAtCall: 0.00001401,
                        callScore: 6,
                        xScore: 7
                    },
                    { 
                        username: 'cryptowhale', 
                        message: 'bonk is back', 
                        roi: 25.45, 
                        timestamp: '2025-01-21 10:35:00',
                        groupName: 'KROM Premium',
                        priceAtCall: 0.00001701,
                        callScore: 8,
                        xScore: 5
                    }
                ]
            },
            {
                ticker: 'PEPE',
                network: 'ethereum',
                contract: '0x6982508145454ce325ddbePEPE',
                fullContract: '0x6982508145454ce325ddbe666a17b72e9c996pepe',
                priceAtCall: 0.00000198,
                currentPrice: 0.00000234,
                liquidity: 450000,
                athRoi: 95.3,
                roi: 18.18,
                marketCap: 1500000,
                volume24h: 234567,
                callScore: 6,
                xScore: 5,
                websiteScore: 4,
                calls: [
                    { 
                        username: 'memecollector', 
                        message: 'pepe szn', 
                        roi: 18.18, 
                        timestamp: '2025-01-21 09:45:00',
                        groupName: 'KROM Premium',
                        priceAtCall: 0.00000198,
                        callScore: 6,
                        xScore: 5
                    }
                ]
            },
            {
                ticker: 'WIF',
                network: 'solana',
                contract: 'EKpQgSJtjMFqKZ9KQanSqYXRcF8fBopzLHYxdM65zcjmWIF',
                fullContract: 'EKpQgSJtjMFqKZ9KQanSqYXRcF8fBopzLHYxdM65zcjmWIF',
                priceAtCall: 1.56,
                currentPrice: 2.45,
                liquidity: 5600000,
                athRoi: 340.2,
                roi: 57.05,
                marketCap: 45000000,
                volume24h: 3456789,
                callScore: 9,
                xScore: 8,
                websiteScore: 7,
                calls: [
                    { 
                        username: 'shibmaster', 
                        message: 'dog season back', 
                        roi: 57.05, 
                        timestamp: '2025-01-21 10:33:00',
                        groupName: 'KROM Premium',
                        priceAtCall: 1.56,
                        callScore: 9,
                        xScore: 8
                    },
                    { 
                        username: 'doggocalls', 
                        message: 'wif looking strong', 
                        roi: 45.23, 
                        timestamp: '2025-01-21 10:40:00',
                        groupName: 'KROM Elite',
                        priceAtCall: 1.69,
                        callScore: 8,
                        xScore: 7
                    }
                ]
            },
            {
                ticker: 'POPCAT',
                network: 'solana',
                contract: '7GCihgDB8fe6KNjn2MYtkzZcRjQy3t9GHdC8uHYmW2hrPOPCAT',
                fullContract: '7GCihgDB8fe6KNjn2MYtkzZcRjQy3t9GHdC8uHYmW2hrPOPCAT',
                priceAtCall: 0.234,
                currentPrice: 0.456,
                liquidity: 1200000,
                athRoi: 520.3,
                roi: 94.87,
                marketCap: 12000000,
                volume24h: 789012,
                callScore: 7,
                xScore: 7,
                websiteScore: 6,
                calls: [
                    { 
                        username: 'catcoins', 
                        message: 'popcat ready to pop', 
                        roi: 94.87, 
                        timestamp: '2025-01-21 10:37:00',
                        groupName: 'KROM Alpha',
                        priceAtCall: 0.234,
                        callScore: 7,
                        xScore: 7
                    }
                ]
            }
        ];

        // Helper functions for formatting
        function formatPrice(price) {
            if (price < 0.00001) return `$${price.toFixed(10)}`;
            if (price < 0.001) return `$${price.toFixed(8)}`;
            if (price < 1) return `$${price.toFixed(6)}`;
            return `$${price.toFixed(2)}`;
        }

        function formatNumber(num) {
            if (num >= 1000000) return `$${(num / 1000000).toFixed(2)}M`;
            if (num >= 1000) return `$${(num / 1000).toFixed(1)}K`;
            return `$${num.toFixed(0)}`;
        }

        function formatDate(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            
            if (diffMins < 60) return `${diffMins}m ago`;
            if (diffMins < 1440) return `${Math.floor(diffMins / 60)}h ago`;
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
        }

        // Render table
        function renderTable() {
            const tbody = document.getElementById('tokenTable');
            tbody.innerHTML = '';

            tokens.forEach((token, index) => {
                // Use the earliest call data for the main row
                const earliestCall = token.calls[0];
                const isMulticall = token.calls.length > 1;
                
                // Main row
                const mainRow = document.createElement('tr');
                mainRow.className = `border-b border-custom hover-row ${isMulticall ? 'cursor-pointer' : ''}`;
                mainRow.id = `token-${index}`;

                mainRow.innerHTML = `
                    <td class="p-3 w-8">
                        ${isMulticall ? 
                            `<svg class="expand-arrow w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                            </svg>` : 
                            '<span class="w-4 inline-block"></span>'
                        }
                    </td>
                    <td class="p-3">
                        <div class="text-sm">${formatDate(earliestCall.timestamp)}</div>
                    </td>
                    <td class="p-3">
                        <div class="flex flex-col">
                            <div class="font-semibold">${token.ticker}</div>
                            <div class="text-xs text-muted truncate max-w-[120px]" title="${token.fullContract}">${token.contract}</div>
                            <div class="text-xs">
                                <span class="px-1.5 py-0.5 bg-gray-800 rounded text-xs">${token.network}</span>
                            </div>
                        </div>
                    </td>
                    <td class="p-3">
                        <div class="text-sm font-medium">${earliestCall.username}</div>
                        <div class="text-xs text-muted">${earliestCall.groupName}</div>
                    </td>
                    <td class="p-3">
                        ${isMulticall ? 
                            `<span class="bg-green-900/50 text-green-400 px-2 py-1 rounded-full text-xs font-semibold">
                                ${token.calls.length} calls
                            </span>` : 
                            `<span class="text-muted text-xs">1 call</span>`
                        }
                    </td>
                    <td class="text-right p-3">
                        <span class="font-semibold ${earliestCall.callScore >= 7 ? 'text-green-400' : earliestCall.callScore >= 5 ? 'text-yellow-400' : 'text-red-400'}">
                            ${earliestCall.callScore}
                        </span>
                    </td>
                    <td class="text-right p-3">
                        <span class="font-semibold ${earliestCall.xScore >= 7 ? 'text-green-400' : earliestCall.xScore >= 5 ? 'text-yellow-400' : 'text-red-400'}">
                            ${earliestCall.xScore}
                        </span>
                    </td>
                    <td class="text-right p-3">
                        <span class="font-semibold ${token.websiteScore >= 7 ? 'text-green-400' : token.websiteScore >= 5 ? 'text-yellow-400' : 'text-red-400'}">
                            ${token.websiteScore}
                        </span>
                    </td>
                    <td class="text-right p-3">
                        <div class="text-sm">${formatPrice(earliestCall.priceAtCall)}</div>
                    </td>
                    <td class="text-right p-3">
                        <div class="text-sm font-medium">${formatPrice(token.currentPrice)}</div>
                    </td>
                    <td class="text-right p-3">
                        <span class="${earliestCall.roi > 0 ? 'text-green-400' : 'text-red-400'} font-bold">
                            ${earliestCall.roi > 0 ? '+' : ''}${earliestCall.roi.toFixed(1)}%
                        </span>
                    </td>
                    <td class="text-right p-3">
                        <span class="text-green-400 font-bold">${token.athRoi.toFixed(1)}%</span>
                    </td>
                    <td class="text-right p-3">
                        <div class="text-sm">${formatNumber(token.marketCap)}</div>
                    </td>
                    <td class="text-right p-3">
                        <div class="text-sm">${formatNumber(token.liquidity)}</div>
                    </td>
                    <td class="text-right p-3">
                        <div class="text-sm">${formatNumber(token.volume24h)}</div>
                    </td>
                `;

                if (isMulticall) {
                    mainRow.onclick = () => toggleExpand(index);
                }

                tbody.appendChild(mainRow);

                // Sub-rows container (hidden by default) - Only show OTHER calls, not the first one
                if (isMulticall) {
                    const subRowsContainer = document.createElement('tr');
                    subRowsContainer.id = `calls-${index}`;
                    subRowsContainer.style.display = 'none';
                    subRowsContainer.innerHTML = `
                        <td colspan="15" class="p-0">
                            <div class="bg-black/50 p-4">
                                <div class="text-xs text-muted mb-3 font-semibold uppercase tracking-wider">Additional Calls for ${token.ticker}</div>
                                <div class="space-y-2">
                                    ${token.calls.slice(1).map((call, callIndex) => `
                                        <div class="sub-row p-3 rounded-lg">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center gap-6">
                                                    <div class="text-xs text-muted w-24">${formatDate(call.timestamp)}</div>
                                                    <div class="flex flex-col">
                                                        <div class="flex items-center gap-2">
                                                            <span class="font-semibold text-sm">${call.username}</span>
                                                            <span class="text-xs px-2 py-0.5 bg-gray-800 rounded">${call.groupName}</span>
                                                        </div>
                                                        <div class="text-sm text-gray-400 mt-1">"${call.message}"</div>
                                                    </div>
                                                </div>
                                                <div class="flex items-center gap-8">
                                                    <div class="text-right">
                                                        <div class="text-xs text-muted">Price at Call</div>
                                                        <div class="text-sm">${formatPrice(call.priceAtCall)}</div>
                                                    </div>
                                                    <div class="text-right">
                                                        <div class="text-xs text-muted">ROI</div>
                                                        <div class="${call.roi > 0 ? 'text-green-400' : 'text-red-400'} font-bold">
                                                            ${call.roi > 0 ? '+' : ''}${call.roi.toFixed(1)}%
                                                        </div>
                                                    </div>
                                                    <div class="flex gap-3">
                                                        <div class="text-center">
                                                            <div class="text-xs text-muted">Call</div>
                                                            <span class="font-semibold ${call.callScore >= 7 ? 'text-green-400' : call.callScore >= 5 ? 'text-yellow-400' : 'text-red-400'}">
                                                                ${call.callScore}
                                                            </span>
                                                        </div>
                                                        <div class="text-center">
                                                            <div class="text-xs text-muted">X</div>
                                                            <span class="font-semibold ${call.xScore >= 7 ? 'text-green-400' : call.xScore >= 5 ? 'text-yellow-400' : 'text-red-400'}">
                                                                ${call.xScore}
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <button class="text-xs px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded">
                                                        View
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(subRowsContainer);
                }
            });
        }

        function toggleExpand(index) {
            const mainRow = document.getElementById(`token-${index}`);
            const callsRow = document.getElementById(`calls-${index}`);
            const arrow = mainRow.querySelector('.expand-arrow');
            
            if (callsRow.style.display === 'none') {
                callsRow.style.display = 'table-row';
                mainRow.classList.add('expanded');
            } else {
                callsRow.style.display = 'none';
                mainRow.classList.remove('expanded');
            }
        }

        // Initial render
        renderTable();
    </script>
</body>
</html>